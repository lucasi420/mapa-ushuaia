<!DOCTYPE html>
<html>
<head>
    <title>Mapa de Nodos y NAPs</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <style>
        #map { height: 90vh; width: 100%; }
        #controls {
            position: absolute;
            top: 10px;
            left: 50px;
            z-index: 1000;
            background: white;
            padding: 5px;
            border-radius: 5px;
        }
        #buscar {
            margin-left: 5px;
        }
    </style>
</head>
<body>

<div id="controls">
    Nodo: 
    <select id="nodoSelect">
        <option value="">-- Elegir --</option>
    </select>
    NAP:
    <select id="napSelect">
        <option value="">-- Elegir --</option>
    </select>
    <button id="buscar">üîç</button>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    // Datos de ejemplo
    const puntos = [
      { nodo: "NODO001", nap: "NAP01", lat: -54.815674, lon: -68.337289, texto: "NODO001 - NAP01 (16)" },
      { nodo: "NODO001", nap: "NAP02", lat: -54.816000, lon: -68.338000, texto: "NODO001 - NAP02 (8)" },
      { nodo: "NODO002", nap: "NAP01", lat: -54.810000, lon: -68.340000, texto: "NODO002 - NAP01 (16)" },
      { nodo: "NODO002", nap: "NAP02", lat: -54.811000, lon: -68.341000, texto: "NODO002 - NAP02 (8)" }

    ];

    const map = L.map('map').setView([-54.815674, -68.337289], 14);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

    // Crear marcadores
    const markers = {};
    puntos.forEach(p => {
        const marker = L.marker([p.lat, p.lon]).addTo(map).bindPopup(p.texto);
        markers[`${p.nodo}-${p.nap}`] = marker;
    });

    const nodoSelect = document.getElementById('nodoSelect');
    const napSelect = document.getElementById('napSelect');

    // Llenar select de NODOS √∫nicos
    const nodosUnicos = [...new Set(puntos.map(p => p.nodo))];
    nodosUnicos.forEach(n => {
        const option = document.createElement('option');
        option.value = n;
        option.textContent = n;
        nodoSelect.appendChild(option);
    });

    // Cuando se selecciona un nodo, llenar el select de NAPs correspondientes
    nodoSelect.addEventListener('change', () => {
        const nodoElegido = nodoSelect.value;
        napSelect.innerHTML = '<option value="">-- Elegir --</option>'; // limpiar NAPs
        if(nodoElegido){
            const naps = puntos.filter(p => p.nodo === nodoElegido).map(p => p.nap);
            naps.forEach(nap => {
                const option = document.createElement('option');
                option.value = nap;
                option.textContent = nap;
                napSelect.appendChild(option);
            });
        }
    });

    // Bot√≥n buscar: centra el mapa en el marcador seleccionado
    document.getElementById('buscar').addEventListener('click', () => {
        const nodo = nodoSelect.value;
        const nap = napSelect.value;
        if(nodo && nap){
            const key = `${nodo}-${nap}`;
            const marker = markers[key];
            if(marker){
                map.setView(marker.getLatLng(), 17);
                marker.openPopup();
            }
        }
    });
</script>

</body>
</html>


